CREATE DATABASE SistemaProdutos;

USE SistemaProdutos;


-- ================================
-- BANCO DE DADOS
-- ================================
CREATE DATABASE SistemaProdutos;
GO

USE SistemaProdutos;
GO

-- ================================
-- TABELAS DE USU�RIO E PERMISSOES
-- ================================

-- Tabela de grupos (Analista, Supervisor, Administrador)
CREATE TABLE Grupos (
    id INT IDENTITY(1,1) PRIMARY KEY,
    nome VARCHAR(50) NOT NULL UNIQUE
);

-- Tabela de usu�rios
CREATE TABLE Usuarios (
    id INT IDENTITY(1,1) PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(150) NOT NULL UNIQUE,
    senha_hash VARCHAR(255) NOT NULL, -- Guardar hash da senha
    data_criacao DATETIME DEFAULT GETDATE() 
);

-- Rela��o N:N entre usu�rios e grupos
CREATE TABLE Usuario_Grupo (
    usuario_id INT NOT NULL,
    grupo_id INT NOT NULL,
    PRIMARY KEY (usuario_id, grupo_id),
    FOREIGN KEY (usuario_id) REFERENCES Usuarios(id) ON DELETE CASCADE,
    FOREIGN KEY (grupo_id) REFERENCES Grupos(id) ON DELETE CASCADE

);

-- ================================
-- TABELA DE PRODUTOS
-- ================================
CREATE TABLE Produtos (
    id INT IDENTITY(1,1) PRIMARY KEY,
    nome VARCHAR(150) NOT NULL,
    descricao TEXT NULL,
    preco DECIMAL(18,2) NOT NULL,
    quantidade INT NOT NULL,
    data_criacao DATETIME DEFAULT GETDATE(),
    usuario_id INT NOT NULL, -- quem cadastrou
    FOREIGN KEY (usuario_id) REFERENCES Usuarios(id) ON DELETE CASCADE
);

-- ================================
-- DADOS INICIAIS
-- ================================

-- Inserir grupos basicos
INSERT INTO Grupos (nome) VALUES 
('Administrador'),
('Analista'),
('Supervisor');

SELECT * FROM Grupos;
SELECT * FROM Usuarios;
SELECT * FROM Produtos;